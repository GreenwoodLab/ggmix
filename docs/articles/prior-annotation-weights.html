<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Incorporating Prior Annotation Weights â€¢ ggmix</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Incorporating Prior Annotation Weights">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ggmix</a>
        <span class="label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased package">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/introduction-to-ggmix.html">Introduction to ggmix</a>
    </li>
    <li>
      <a href="../articles/prior-annotation-weights.html">Prior annotation weights</a>
    </li>
    <li>
      <a href="../articles/alternative-kinship-input.html">Alternative input for population structure</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions and data</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/sahirbhatnagar/ggmix">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Incorporating Prior Annotation Weights</h1>
                        <h4 class="author">Sahir Rai Bhatnagar</h4>
            
            <h4 class="date">2018-06-28</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/sahirbhatnagar/ggmix/blob/master/vignettes/prior-annotation-weights.Rmd"><code>vignettes/prior-annotation-weights.Rmd</code></a></small>
      <div class="hidden name"><code>prior-annotation-weights.Rmd</code></div>

    </div>

    
    
<p>There may be external information that you would like to be reflected in the linear mixed model. For example, weighting variants according to their minor allele frequency. You may also want to up-weight rare variants. This can be achieved by using the <code>penalty.factor</code> argument in the <code>ggmix</code> function. This will allow you to apply a different penalty to each variable.</p>
<div id="setting-the-penalty-factor-argument" class="section level2">
<h2 class="hasAnchor">
<a href="#setting-the-penalty-factor-argument" class="anchor"></a>Setting the Penalty Factor Argument</h2>
<p>We use the <code>admixed</code> data to show how we can apply different penalties to each variable. By default, every variable gets a <code>penalty.factor</code> of 1, which is equivalent to applying a penalty of <span class="math inline">\(\lambda\)</span> to each variable. A <code>penalty.factor</code> less than 1 will apply less of a penalty to that variable. In particular, any variable with a <code>penalty.factor</code> of 0 will not be penalized. Note that the lambda sequence, which is automatically calculated by the <code>ggmix</code> function, may change due to the different <code>penalty.factors</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggmix)
<span class="kw">data</span>(<span class="st">"admixed"</span>)

<span class="co"># the default penalty factor</span>
p.fac &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>, <span class="kw">ncol</span>(admixed<span class="op">$</span>x))

<span class="co"># set 5 of the causal SNPs to not be penalized at all</span>
p.fac[<span class="kw">match</span>(<span class="kw">sample</span>(admixed<span class="op">$</span>causal, <span class="dv">5</span>),<span class="kw">colnames</span>(admixed<span class="op">$</span>x))] &lt;-<span class="st"> </span><span class="dv">0</span>

<span class="co"># supply p.fac to the penalty.factor argument</span>
res &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ggmix.html">ggmix</a></span>(<span class="dt">x =</span> admixed<span class="op">$</span>x, <span class="dt">y =</span> admixed<span class="op">$</span>y, <span class="dt">kinship =</span> admixed<span class="op">$</span>kin,
             <span class="dt">penalty.factor =</span> p.fac)
<span class="kw">plot</span>(res)</code></pre></div>
<p><img src="prior-annotation-weights_files/figure-html/unnamed-chunk-1-1.png" width="700"></p>
<p>We can see from the solution path plot above, that there are 5 lines that are never 0, because they are never penalized, and thus always remain in the model.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#setting-the-penalty-factor-argument">Setting the Penalty Factor Argument</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="https://sahirbhatnagar.com">Sahir Bhatnagar</a>, <a href="https://karimoualkacha.uqam.ca/">Karim Oualkacha</a>, <a href="http://www.math.mcgill.ca/yyang/">Yi Yang</a>, <a href="https://www.mcgill.ca/statisticalgenetics/">Celia Greenwood</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script><script>
  docsearch({
    
    
    apiKey: 'f8a14d62b00c65f3af4a90aa62a286b8',
    indexName: 'ggmix',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
